<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>benaryorg.github.io</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="benaryorg&#x27;s blag">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="ramble.html"><strong aria-hidden="true">2.</strong> Ramble</a></li><li class="chapter-item expanded "><a href="legacy/index.html"><strong aria-hidden="true">3.</strong> Legacy</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.1.</strong> Programming</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="legacy/programming/getting_started.html"><strong aria-hidden="true">3.1.1.</strong> Getting Started With Programming</a></li><li class="chapter-item expanded "><a href="legacy/programming/plain_code.html"><strong aria-hidden="true">3.1.2.</strong> Plain Code</a></li><li class="chapter-item expanded "><a href="legacy/programming/a_to_b.html"><strong aria-hidden="true">3.1.3.</strong> A to B</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.2.</strong> Meta</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="legacy/meta/how_to_build_a_regexp.html"><strong aria-hidden="true">3.2.1.</strong> How to build a RegExp?</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="assignments.html"><strong aria-hidden="true">4.</strong> Assignments</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">4.1.</strong> Programming</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="assignments/programming/finbean_linked_list.html"><strong aria-hidden="true">4.1.1.</strong> Finbean Linked List</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">benaryorg.github.io</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>So you've found my <a href="https://xkcd.com/148/">blag</a>?
It's not like I've deliberately hidden so yeah, figures.</p>
<p>At some point I wanted to write a few articles about how I write code, and I actually started writing those.
You can find them in the <em>Legacy</em> section.</p>
<p>In case you read this in a far away future in which I actually did follow through with my plan; chances are you'll also see a few entries in a journal-like fashion.
I've been pondering about it for a while and it seems feasible to actually jot down notes while doing some work and then just sort those notes when I'm done doing whatever I was doing and using that as both a journal and a blog that I can refer to at the same time.
As said, far away future, so if you're looking for that and it's not here yet, chances are it doesn't even exist.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ramble"><a class="header" href="#ramble">Ramble</a></h1>
<p>This is the mandatory ramble section I guess.
Here I'll explain some of my background and what this is all about.</p>
<p>I'm currently typing this on my semi-freshly acquired <code>aarch64</code> tablet convertible.
The device is nice, it's basically a portable Linux device which I can use for typing stuff on the go, or with some tinkering maybe even play games on the go.
The crux is however is that computers are mind-bogglingly stupid<sup class="footnote-reference"><a href="#h2g2-ref-1">1</a></sup>.</p>
<p>Contrary to the popular opinion of "the computer deleted my file" or "the computer keeps downloading files to the wrong directory" we did not actually make sand <em>think</em>, not yet anyway.
All a computer ever does is what someone told it to do, specifically, in a structured format that the computer can follow; this applies to all computers regardless of whether it's a physical device, some emulator, or even the JVM – or any byte code interpreter for that matter.
They are incredibly single-minded if you can even call it that.
The problems that people have with computers are usually one of three things (IMHO, YMMV): hardware failure, interoperability, and "someone told this computer to do something I don't like".
The first one is unavoidable to some extent.
The second one is usually some vendor lock-in or some hardware standards thing, often caused by <a href="https://en.wikipedia.org/wiki/Not_invented_here">NIH</a> link, or some other <a href="https://en.wikipedia.org/wiki/Enshittification">enshittification</a> thing, avoidable to some extent, but also historical baggage more often than not.
The last one.… well, this includes everything from hardware, via firmware, to software, up to and including settings, presets, etc., and it's one of the primary reasons why <a href="https://en.wikipedia.org/wiki/Free_and_open-source_software">FOSS</a> came into existence.
So when someone says "the computer keeps downloading files to the wrong directory" what the underlying message is "someone configured the software on this computer to download files to a different directory than I want them in".
I am <em>not</em> blaming the person who is using the computer.
Sure, they <em>may</em> have explicitly set the wrong directory in their browsers preferences, but with the amount of software we shove into these boxes it may also be the complex interaction of three pieces of software all of which have different conventions and configurations.
<em>Someone</em> configured those, either explicitly as a user, or implicitly through defaults shipped by your upstream vendor, or the defaults set in the software, or straight out "defaults" in terms of the way the code is written in.
If the code of a software never checks the configuration setting you are setting despite it being the way to set things as per documentation then yes, someone forgot to tell the computer to ask you for your opinion (and you're just giving your opinion to the void).
Right here and right now it is important to say that yes, there's always a person to point at, but no, you shouldn't actually do that.
All of these "configuration choices" happen for a reason, and rarely is it just a simple mistake.</p>
<ul>
<li>often because software follows a standard (like the XDG specs for your desktop)</li>
<li>sometimes because people didn't know the standard (when someone uses public IPv4 addresses in their private network because they didn't know about <a href="https://datatracker.ietf.org/doc/html/rfc1918">RFC 1918</a>)</li>
<li>time or other resource constraints (like how my infrastructure is largely not available via Legacy IP<sup class="footnote-reference"><a href="#legacy-ip">2</a></sup> because it's just not worth it for me)</li>
<li>unfortunately also because companies don't give a flying duck about making something configurable or even <em>usable</em> for a user (go ask Nintendo what <a href="https://web.archive.org/web/20240207134431/https://en-americas-support.nintendo.com/app/answers/detail/a_id/667/~/nintendo-3ds-system-update-history">that big warning notice on the 3DS update history</a> is all about)</li>
</ul>
<p>And in this case – a Chromebook – someone at Google thought of a really fancy way to boot this device with some custom (largely?) Open Source firmware and whatnot to enable a very fast and verified boot, with signatures and such, to prevent intrusions.
I don't know why it was necessary to optimize the boot times of the bootloader of all things, but hey, at least the source code is available and the documentation is actually usable.
The intentions here aren't really relevant right now, suffice to say getting mainline Linux to boot on these devices requires packing of the kernel and initrd in a special format (<a href="https://chromium.googlesource.com/chromiumos/platform/depthcharge/">Depthcharge</a>) to get the device to recognize this (not to mention persisting dev mode and tinkering with firmware write protection to disable verified boot).
Okay, so far so good, this isn't the most complex computer thing I've done before.
Why am I telling you all this?
Well, first of all, this is the ramble section, what did you expect?
Second, and much more importantly, because in trying to change something about this I had to learn a hard lesson — again.
What I was trying to do is deploy <a href="https://docs.u-boot.org/en/latest/index.html"><em>Das U-Boot</em></a> as a <em>kpart</em> image (like the kernel) so I could teach this device to just boot from a partition, which would have made testing and updating kernels much easier.
There is even a documentation section on this exact thing, except it's for the device codenamed <em>snow</em> with <em>jerry</em> being listed as an alternative.
I am writing this on <em>krane</em> however.</p>
<p>Now comes the relevant part that I've been meaning to get to; I'm a network engineer.
I love routing packets from one device to the next.
That's what I do at home.
I also tinker with my software a bit, but usually nothing that nobody's done before.
That thing however?
No dice.
The Linux kernel has <a href="https://en.wikipedia.org/wiki/Devicetree">DTBs</a> for my device (and the entire family), heck <a href="https://mobile.nixos.org/"><em>mobile-nixos</em></a> has this entire device family covered including the <em>kpart</em> generation using <em>depthcharge</em>.
U-Boot has none of that.
No DTBs – okay, I can copy those off of the Linux build.
No defconfig – okay, I used to compile my own kernels shouldn't be that hard.
Nothing on the internet on what I need for this device type and the closest in the U-Boot tree with a defconfig was a single device with an <em>mt8183</em> that didn't quite match my hardware.
This is where I get stuck.</p>
<p>I – as a sysadmin-ish hybrid developer networking person – require documentation to base my stuff off of, and whenever something diverges from my – admittedly very broad – experience I get stuck.
This entire blog is about writing down whatever I know so that I can reference it and so that other people can try and build stuff off of whatever I do.
That is if I can actually keep up the writing, something I wouldn't bet on, but you never know what life throws at you, eh?</p>
<p>\</p>
<div class="footnote-definition" id="h2g2-ref-1"><sup class="footnote-definition-label">1</sup>
<p>I can't promise that this was the last H₂G₂ reference. \</p>
</div>
<div class="footnote-definition" id="legacy-ip"><sup class="footnote-definition-label">2</sup>
<p>When I say <em>Legacy IP</em> I refer to IPv4. I don't like IPv4, and I'd rather we fully commit to IPv6 already. \</p>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="legacy"><a class="header" href="#legacy">Legacy</a></h1>
<p>This is the legacy section of this blag.
As the same suggests all of these posts have been carried over from the previous version, so they may not be complete, up-to-date, or anything at all.
Better old than lost I guess.?</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started-with-programming"><a class="header" href="#getting-started-with-programming">Getting Started With Programming</a></h1>
<p>Hi there, welcome to a fast (depending on how fast you read) and quick
(actually really in depth if I manage to keep going).</p>
<p>What I will do:</p>
<ul>
<li>explain computers
<ul>
<li>a bit of hardware maybe</li>
<li>a whole lot of software</li>
<li>sprinkled with operating system stuff</li>
</ul>
</li>
<li>explain programming
<ul>
<li>concepts</li>
<li>ideas</li>
<li>best practices</li>
</ul>
</li>
<li>explain languages in detail
<ul>
<li>some, I don't really know which yet, I just started to write something so
this might be a little weird</li>
</ul>
</li>
</ul>
<h1 id="theory"><a class="header" href="#theory">Theory</a></h1>
<p>You can happily skip this whole chapter.
I earlier said this will be in depth so here you go:</p>
<blockquote>
<p>Computers are stupid.</p>
</blockquote>
<p>To understand why, let me just summarise:</p>
<ol>
<li>Computers do exactly what you tell them
<ul>
<li>if you tell them to kill themselves they'll do</li>
<li>if you tell them something they don't understand they'll try to make
themselves understand (often by just doing random things)
<ul>
<li>that got better in recent years, we now have smarter interpreters,
compilers, OSes and whatnot. Stuff usually tells you right away that
it doesn't know what to do with your instructions</li>
</ul>
</li>
</ul>
</li>
<li>Computers have not a lot of instructions you can give them
<ul>
<li>this however doesn't apply to other software, you can and will instruct a
lot of foreign software to do things for you
<ul>
<li>foreign code can contain bugs of their own</li>
</ul>
</li>
</ul>
</li>
<li>Computers as whole, starting at the hardware and going all the way up, are
just so incredibly complex that you will never understand everything about
them. <a href="https://xkcd.com/1605/">relevant xkcd</a></li>
</ol>
<h2 id="what-is-a-computer"><a class="header" href="#what-is-a-computer">What is a Computer?</a></h2>
<p>Basically a computer consists of CPU and RAM.
In most computers you'll find other things like disks or peripherals.</p>
<p>Peripherals include:</p>
<ul>
<li>output devices
<ul>
<li>monitors</li>
</ul>
</li>
<li>input devices
<ul>
<li>keyboards</li>
<li>mice</li>
</ul>
</li>
<li>both
<ul>
<li>parallel/serial ports</li>
<li>network</li>
</ul>
</li>
</ul>
<p>*[CPU]: Central Processing Unit
*[RAM]: Random Access Memory</p>
<p>Imagine a computer that just computes using CPU and RAM.…
You had no way of getting data into the computer and no way of getting it out,
that would be pretty pointless.</p>
<p>Now think of the <a href="https://xkcd.com/927/">Standards problem</a>.
There is a whole lot of entirely different hardware out there.
You can't just be compatible to all hardware.
Period.
That is why I am introducing you to the concept of the Stack.</p>
<h2 id="the-stack"><a class="header" href="#the-stack">The Stack</a></h2>
<p>A stack (English: stack) is what happens when you want to go to bed and are too
tired to put your clothes somewhere and just throw them in the same corner
every night and take fresh ones in the morning.
This is about the same with computers just a little broader and occasionally
less high.</p>
<h3 id="bottom"><a class="header" href="#bottom">Bottom</a></h3>
<p>So at the bottom of the stack there is our hardware.
CPU, RAM, disks, peripherals and all the other nice things.</p>
<p>There are chips on your mainboard (the part that connects all of the other
things) that handle voltage of the other parts, make it possible to keep your
finger long on the power button to kill your computer and much more things.</p>
<p>There is also a chip containing a BIOS or UEFI.
Either of them is the bottom of the software stack.
I'll just assume a BIOS.</p>
<p>*[BIOS]: Basic Input and Output System
*[UEFI]: newer than BIOS, but not necessarily better.</p>
<p>The BIOS initialises devices and provides some way of configuring certain very
low-level (very deep down the stack) configuration options.
This can for example be "where to boot from".
If you just boot from the internal disk it will read the first 512 bytes from
the disk and interpret those.</p>
<h4 id="binary"><a class="header" href="#binary">Binary</a></h4>
<p>Oh right.…
Some long time ago computer people decided they need to store data in some way.
The most hardwarish way to do that, as early computers were the size of a
house and did mostly consist of hard-wired logic, was to build some electronic
part that could store a simple signal:</p>
<div class="table-wrapper"><table><thead><tr><th>State</th><th>Number</th></tr></thead><tbody>
<tr><td>Off</td><td>0</td></tr>
<tr><td>On</td><td>1</td></tr>
</tbody></table>
</div>
<p>This is what we call a "bit".
A bit is not very much.
So we just take eight of them and call it a "byte".
If you have a byte written out in numbers it would be between (inclusive)
<code>00000000</code> (lowest) and <code>11111111</code> (highest).
Now, if we count the number of different patterns we can store inside that we
will count exactly 256.</p>
<p>Memory, so both disks, RAM and everything else that stores data is just a long
array of bytes of which each one can be individually read and set.</p>
<p>More to be read on <a href="https://en.wikipedia.org/wiki/Binary_number">Wikipedia</a>.</p>
<h3 id="but-back-to-the-bios"><a class="header" href="#but-back-to-the-bios">But back to the BIOS</a></h3>
<p>So, the BIOS reads 512 bytes which it interprets.
These bytes are called the MBR.
The MBR can then again instruct the BIOS to do things like loading data from a
harddisk, store it in RAM.
It can even instruct the BIOS to jump to the location in RAM where it just
loaded data to and the data is then executed by the CPU.</p>
<p>*[MBR]: Master Boot Record</p>
<p>Okay, so we managed to get from the hardware all the way up to executing custom
code on the CPU.
This means this code now has full control over the entire computer.
What it does?
Well, the process of starting a computer is called "booting".
There are several parts involved in booting, including a "bootloader".</p>
<h3 id="bootloader"><a class="header" href="#bootloader">Bootloader</a></h3>
<p>The bootloader consists of at least two parts, the first part being the MBR.
As 512 bytes don't really give you a lot of opportunity to do something other
than loading stuff to memory and jumping to it the second part naturally is the
code being loaded to memory and executed.
We call it the second stage bootloader.</p>
<p>This bootloader has a lot more space at hand and can therefore do things such
as presenting a menu to you on screen and reading input from your keyboard to
assist in doing things.</p>
<p>Examples of bootloaders include:</p>
<ul>
<li>Linux
<ul>
<li>LiLo</li>
<li>Grub</li>
<li>syslinux</li>
</ul>
</li>
<li>Windows
<ul>
<li>ntldr</li>
<li>bootmgr</li>
</ul>
</li>
</ul>
<p>This second bootloader often is large enough to know how to properly read other
data than just "the first 512 byte" meaning it can already read data from the
disk that determines it's behaviour.
This usually means that you can already use configuration files or an
equivalent to instruct this part of the bootloader.</p>
<p>The bootloader then continues to load the first bit of your Operating System,
called the "kernel".</p>
<h3 id="kernel"><a class="header" href="#kernel">Kernel</a></h3>
<p>From here on things are quite different depending on your OS so I'll save it
for a later blog post.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="plain-code"><a class="header" href="#plain-code">Plain Code</a></h1>
<p>In the first blog post I've covered some theory about computers in general so
how about we start programming now?</p>
<p>This post might seem a bit boring as we will neither talk about how to actually
run the code nor will the code actually output something or interact with
anything.</p>
<h1 id="programming-languages"><a class="header" href="#programming-languages">Programming Languages</a></h1>
<p>Syntax describes the structure of code.
A programming language is just a way of telling a computer what to do in human
readable form.
The only thing that programming languages differ in is syntax.
That last sentence is just plain wrong.</p>
<p>Every programming language does have some features that set it apart from
others, unless somebody felt the need to reinvent the wheel, wasn't aware of
the other language(s) or developed it at the same time.
Features might be different <a href="https://en.wikipedia.org/wiki/Programming_paradigm">programming
paradigms</a> such as
declarative versus imperative programming.</p>
<p>For the sake of simplicity I will just choose the language C, not because it is
particularly modern or has a lot of features but because it is lacking magic
and is therefore easier to understand because nothing strange is going on
behind the scenes and because C is nowadays used as a whole category of syntax.
C-like syntax is common; Java, Rust, PHP, JavaScript, it's just everywhere.</p>
<h1 id="first-steps"><a class="header" href="#first-steps">First Steps</a></h1>
<p>Let's get into it.</p>
<p>Every program needs a starting point, in case of C it is called <code>main</code>.</p>
<p>Let's do something simple: a program that does nothing.</p>
<pre><code class="language-c">// this is a comment
void main(void)
{
}
</code></pre>
<p>So, what can we see here?</p>
<p>First thing: a comment is something you can only see in the source code.
It is just ignored by literally everything.</p>
<p>Second: we see <code>main</code> right?
But what's the stuff around it you ask?
Well, <code>void</code> means <em>nothing</em>.</p>
<p>C is typed, meaning everything has a type.
The notation used for declaring things in C is one of the below:</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Declaration</th></tr></thead><tbody>
<tr><td>Variable</td><td><code>type name</code></td></tr>
<tr><td>Array</td><td><code>type name[length]</code></td></tr>
<tr><td>Function</td><td><code>return_type name(variables)</code></td></tr>
</tbody></table>
</div>
<p>That means we are declaring a function named <code>main</code> (our entry point) that
"computes" nothing and needs nothing to do that.
Seems about right.</p>
<p>Furthermore we have curly braces that denote the function body: the start and
end of the function.</p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<p>Functions aka subroutines, are pieces of code which you can use from other
places.
This could for example be used for establishing a connection to a server.</p>
<p>A function does have input and output, both of which can be nothing aka <code>void</code>.</p>
<p>In the example of the connection this function could look like:</p>
<pre><code class="language-c">connection connect(address server,number port)
{
	// do something
	return some_variable_of_type_connection;
}
</code></pre>
<h2 id="variables"><a class="header" href="#variables">Variables</a></h2>
<p>Variables are easy.
A variable is a piece of memory with a fixed size.
As soon as you have a variable you can do with it's memory whatever you like.</p>
<p>C does have certain types of variables defined for you (assuming x86_64
platform):</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Size</th><th>Type</th><th>Values</th></tr></thead><tbody>
<tr><td>Integer</td><td>4 byte</td><td><code>int</code></td><td>-2147483648 to 2147483647</td></tr>
<tr><td>Short</td><td>2 byte</td><td><code>short int</code></td><td>-32768 to 32767</td></tr>
<tr><td>Character</td><td>1 byte</td><td><code>char</code></td><td>-128 to 127</td></tr>
<tr><td>Pointer</td><td>8 byte</td><td><code>type *</code></td><td>reference to memory</td></tr>
<tr><td>Double</td><td>8 byte</td><td><code>double</code></td><td>very low to very high floating point</td></tr>
<tr><td>Float</td><td>4 byte</td><td><code>float</code></td><td>low to high floating point</td></tr>
</tbody></table>
</div>
<p>Integral types including characters can be made <code>unsigned</code> by prefixing them
with unsigned, making them hold only positive numbers, extending their upper
bounds by the capped lower bounds.</p>
<h3 id="integer"><a class="header" href="#integer">Integer</a></h3>
<p>An integer is just an integral number, meaning one or two, but not 1.5.
You can multiply it's value, divide it and do weird things with it.</p>
<h3 id="character"><a class="header" href="#character">Character</a></h3>
<p>Characters are used for text.
Meaning you can easily store <code>'a'</code> or <code>'b'</code> and using pointers or arrays whole
words sentences or whatever you want, we call that a <em>string</em>.</p>
<p>If you are storing an actual character in a <code>char</code> as opposed to a number, then
you will find yourself using ASCII, which is just a standard assigning specific
numbers to letters.
<code>'a'</code> for example equals the number 97.
You usually don't use the numbers directly but character notation:</p>
<p>*[ASCII]: American Standard Code for Information Interchange</p>
<pre><code class="language-c">char difficult = 97;
char easy = 'a';
</code></pre>
<p>ASCII table and other things about ASCII to be found
<a href="https://en.wikipedia.org/wiki/ASCII">here</a>.</p>
<h3 id="floating-point"><a class="header" href="#floating-point">Floating Point</a></h3>
<p>There is a nice <a href="https://en.wikipedia.org/wiki/IEEE_floating_point">IEEE
standard</a>, just read that.
No, I'm joking, just deal with it that you can store things like <code>0.5</code> inside
them but that it is not guaranteed that they equal or be exact.
If you can, use an integer instead.
Especially when dealing with currency.
If you deal with currency, just store the smallest unit as integers.</p>
<h2 id="array"><a class="header" href="#array">Array</a></h2>
<p>You need fifty integers?
Just use <code>int [50]</code>.</p>
<p>You can then access it using <code>name[index]</code>.</p>
<p><strong>Warning:</strong> the first index is 0, not 1.</p>
<h1 id="pointers"><a class="header" href="#pointers">Pointers</a></h1>
<p>No, I haven't yet explained them.
Most people consider them annoying because they always make your programs
crash (when you use them wrong).
Pointers are easy, just think of them as an integer that holds an address in
memory.
I've already told you, a variable isn't any different from a few bytes in
memory.
A simple example:</p>
<pre><code class="language-c">// get four bytes and write 42 into them
int data = 42;

// store the data's address
int *ptr = &amp;data;

// get more bytes and store the data the ptr points at
int newdata = *ptr;
</code></pre>
<h2 id="pointers-and-functions"><a class="header" href="#pointers-and-functions">Pointers and Functions</a></h2>
<pre><code class="language-c">// sets the memory at some address to the answer
void get_answer(int *data)
{
	*data = 42;
}

// get some bytes
int data = 4;

// set that memory address' memory to the answer
get_answer(&amp;data);
</code></pre>
<p>Why would you want this?
You'll know when, but if it's possible to do without pointers, try that,
unless of course it has serious disadvantages.</p>
<h2 id="when-pointers-go-bad"><a class="header" href="#when-pointers-go-bad">When Pointers Go Bad</a></h2>
<pre><code class="language-c">// just point at some address in memory where we don't have data
int *data = 0;

// access the data
*data;

// program crashes above
</code></pre>
<p>Why is 0 special?
Well, some people thought, why don't take 0 as a special value for "pointer
points at nothing".
Since then this is convention.
All modern operating systems have the address 0 always "unmapped" meaning if
you try to access it, whether it be read or write, the program instantly
crashes.</p>
<h2 id="pointers-and-arrays"><a class="header" href="#pointers-and-arrays">Pointers and Arrays</a></h2>
<p>The name of an array without any index given is a pointer to the memory of the
array, meaning you can use it to pass arrays to functions (which is otherwise
not permitted).
This is also nice if you got your memory from somewhere else than an array
declaration.</p>
<p>Furthermore it means that not only is your array a pointer but also that any
pointer is an array.</p>
<p>Therefore you can do things like that:</p>
<pre><code class="language-c">// returns the second element
int second(int *arr)
{
	// remember that the first index is 0
	return arr[1];
}

// create an array with two elements (0 and 1)
// and fill it with the values 1337 and 42
int arr[2] = {1337,42};

// store the result (42) of `second` into `snd`
int snd = second(arr);
</code></pre>
<h2 id="pointer-arithmetic"><a class="header" href="#pointer-arithmetic">Pointer Arithmetic</a></h2>
<p>You can add some numbers to integers and characters of course, but what about
pointers?
If you add or subtract some number from/to a pointer then the result is a
pointer shifted by that <strong>amount</strong>.
Amount in this case means that it is shifted by a number of units of the type
of the pointer.</p>
<p>An example:</p>
<pre><code class="language-c">// pointer at the start of the ram at address 0
int *ptr = 0;

// pointer to the second integer in memory
// this means it points at the address 4
int *further = ptr+1;
</code></pre>
<p>I wrote "the second integer in memory" which is kind of a contrary statement to
what I said before.
Memory is just a bunch of bytes.
On RAM level there is no such thing as an integer.
But if you write C code that declares some memory address to be handled as an
integer then it will be handled as that, even if it's not.</p>
<p>We can see this easily in an example like this:</p>
<pre><code class="language-c">// regular integer (4 byte)
int i = 1337;

// use the four bytes of `i` as an array
char *arr = &amp;i;

// we can now access the individual parts of the array
arr[0]; // 57
arr[1]; // 5
arr[2]; // 0
arr[3]; // 0
</code></pre>
<p>Something worth noting here is that the first element (0) contains the lowest
byte of the integer.
This is because the platform I am assuming (x86_64) is "little endian".
More information on <a href="https://en.wikipedia.org/wiki/Endianness">Wikipedia</a>.</p>
<h2 id="strings"><a class="header" href="#strings">Strings</a></h2>
<p>Strings as mentioned above are a special kind of array, a character array.
They are very important because in an application you often deal with character
arrays, whether it be user input, network connections or just simple output,
you always work with byte arrays.</p>
<p>Strings do have some special value at the end, a zero.
This is used for termination.
Why you ask?
Well, imagine an array which holds the text a user entered; variable length and
definitely no NUL value inside.
Now it is your job to do things with it.
How do you know where it ends?
You see that having a 0 at the end is perfect for telling where a string ends.</p>
<p>And because we use strings that often there is a convenient way to write them:</p>
<pre><code class="language-c">// we can leave the number out if we directly initialize it
// because the length is known at compile-time because we set the values
char array[] = {97,104,97,0}; // ASCII for "aha" and a zero at the end

// means the same (including the zero at the end).
char same[] = "aha";
</code></pre>
<h1 id="to-be-continued"><a class="header" href="#to-be-continued">To Be Continued</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="my-way-of-programming"><a class="header" href="#my-way-of-programming">My Way of Programming</a></h1>
<p>Herein I will describe <em>my programming style</em> as well as my experience with
Haskell, as an example for purely functional programming.</p>
<p>I sometimes call my style of programming <em>a-to-b programming</em>.
To make this whole thing more practical I will just add a few examples written
in Haskell.</p>
<h1 id="a-to-b"><a class="header" href="#a-to-b"><em>a-to-b</em></a></h1>
<p>What do I mean by <em>a-to-b</em>?
Every single application I know is basically just performing data
transformation.
You have some data <em>a</em> of which you make some data <em>b</em>.</p>
<h2 id="application"><a class="header" href="#application">Application</a></h2>
<p>This does not hold true for IO, which includes:</p>
<ul>
<li>storage applications
<ul>
<li>databases (PostgreSQL)</li>
<li>caches (varnish)</li>
<li>key-value stores (memcached)</li>
</ul>
</li>
<li>one-way communication</li>
</ul>
<p>It does however hold true for applications which you might not expect to be
designed that way:</p>
<ul>
<li>generic web applications: <code>([DataBaseRow],Request) -&gt; ([DataBaseModification],Response)</code></li>
<li>command line applications: <code>([CliParameter],StdIn) -&gt; (ExitCode,StdOut)</code></li>
</ul>
<h1 id="functional-programming"><a class="header" href="#functional-programming">Functional Programming</a></h1>
<p>So how does all of that relate to functional programming (and Haskell)?
Imagine a complete web application which is structured into smaller parts each
doing one single thing (adhering to the UNIX philosophy).
One of these modules could be something along the lines:</p>
<pre><code class="language-haskell">-- called with a "map" from path to image and the request
-- returns the response to be sent
handleRequest :: [(Path,Image)] -&gt; Request -&gt; Response
handleRequest images request =
	makeResponse
		(
			resizeImage 
				(getDimension request) 
				(lookup (getPath request) images)
		)

-- creates a response from an image (add headers and so on)
makeResponse :: Image -&gt; Response
-- resize the image somehow
resizeImage :: Dimension -&gt; Image -&gt; Image
-- get the requested dimension from the request
getDimension :: Request -&gt; Dimension
</code></pre>
<p>Dear Haskellers, please excuse me for leaving out the <code>Maybe</code> part of the
<code>lookup</code> function.
It's for readability.</p>
<p>Dear Non-Haskellers, believe me if I tell you that Haskell's type system kind
of pushes you into the right direction.</p>
<h1 id="benefits"><a class="header" href="#benefits">Benefits</a></h1>
<p>These benefits are applicable to both Functional Programming and the <em>a-to-b</em>
model:</p>
<h2 id="state"><a class="header" href="#state">State</a></h2>
<p>No state-keeping within your logic.
Have a look at the <code>handleRequest</code> function above.
It does not keep state at all.
If anything was to keep state it might just get one state as an argument and
return the new state.
The state-keeping would then be abstracted from your application.
If talking about web applications this could be your session, stored in
<em>memcached</em> transparently.
Combined with Haskell's laziness you'd probably end up not even requesting
unneeded state.</p>
<h2 id="parallelisable"><a class="header" href="#parallelisable">Parallelisable</a></h2>
<p>There will be no race conditions in this code.
You will be able to quickly scale out with more threads or even more hosts if
needed.
You get all this "for free".</p>
<h2 id="reproducible"><a class="header" href="#reproducible">Reproducible</a></h2>
<p>Oh noes, you found a bug.
Good luck reproducing this without full step-by-step instructions.
With functional programming you simply need to log your state and request as
soon as an error occurs and you have everything you need to reproduce it.
Debugging will be ridiculously easy.</p>
<h2 id="side-effect-free"><a class="header" href="#side-effect-free">Side-Effect Free</a></h2>
<p>If you have a high unit-test coverage then you have actually tested everything
that could go wrong because there are no side-effects in pure functions.</p>
<h2 id="maintenance"><a class="header" href="#maintenance">Maintenance</a></h2>
<p>You can easily replace a function that does not perform as it should and, once
it works, it probably keeps on working forever.</p>
<h2 id="profiling"><a class="header" href="#profiling">Profiling</a></h2>
<p>If you profile your application you see how long each function takes and how
often it's called.
This makes it easy to find a bad performing function and simply rewrite it, if
possible, or reduce it's usage or the way it's used.</p>
<h2 id="shipping-features"><a class="header" href="#shipping-features">Shipping Features</a></h2>
<p>Adding a feature is as easy as adding the new functions and putting a call to
them somewhere.
You cannot break any of the existing parts of the program if you do not touch
them due to the complete lack of side-effects.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-build-a-regexp"><a class="header" href="#how-to-build-a-regexp">How to build a RegExp?</a></h1>
<p>I see people abusing regexes just about every day.
If you're really good at regexes then you will certainly feel some sort of pain
as soon as you see <code>.*</code> or similar constructs in inappropriate places.</p>
<p>So here is my guide to doing it the right way.</p>
<h2 id="notes"><a class="header" href="#notes">Notes</a></h2>
<p>I'm going to use PCRE all over the place.
My preferred syntax is <code>m{something}</code> and <code>s{a}{b}g</code> so I'll stick with those.</p>
<p>You can try all examples using:</p>
<pre><code class="language-bash"># for searches, just start typing, quit using ^D
perl -ne 'm{a(.)c} &amp;&amp; print "$1\n"'
# for replacements
perl -pe 's{a.c}{abc}g'
</code></pre>
<h2 id="why-not-use-"><a class="header" href="#why-not-use-">Why not use <code>.*</code>?</a></h2>
<p>You're looking for a needle in a haystack.
A practical example: you look for your favourite plushie in your room.</p>
<p>A nice regex for that would be <code>m{\bplushie\b}</code>.
It looks for your plushie as one word, meaning that it will match only if on
each side the word ends.
See also <a href="http://www.regular-expressions.info/wordboundaries.html">word
boundaries</a>.</p>
<p>What I see people do, which is completely ridiculous, is
<code>m{^.*\bplushie\b.*$}</code>.</p>
<p>Let me explain:</p>
<ul>
<li>They match the beginning of the line even though they don't need it.</li>
<li>They match the end of the line.</li>
<li>They let their parser go through all of the characters, even though they
already found what they were looking for.</li>
</ul>
<p>If you look for an occurrence somewhere, that does not need to be anywhere
specific then why are you looking at everything else?
You don't walk into your room and start looking from one side sequentially to
the other.
What you do is look in your room, see the plushie sitting on the bed and take
it.</p>
<h2 id="complex-examples"><a class="header" href="#complex-examples">Complex Examples</a></h2>
<p>Let's choose <em>fail2ban</em> as an example.
We want to block every IP sending more than 1000 HTTP requests per five
seconds.
I'll ignore how to configure <em>fail2ban</em> as it's not relevant to the regex
thing.</p>
<p>First try, without even looking at the format of the logs: <code>m{^.*&lt;HOST&gt;.*$}</code></p>
<p>You probably messed up very hard here.
To explain why you've messed up so hard, let's look at one line of logs:</p>
<pre><code class="language-text">10.0.0.1 - - [16/Jul/2017:15:38:54 +0200] "GET /robots.txt HTTP/1.0" 404 319 "-" "Mozilla/5.0 (compatible; AhrefsBot/5.2; +http://ahrefs.com/robot/)" "-"
</code></pre>
<p>I took that line out of my server, the <em>10.0.0.1</em> is the part that we want
(please ignore that it's an internal IP).</p>
<p><code>m{.*}</code> does greedy matching, so the above regex will be very easy to break.
Just put an IP in the User Agent.
The User Agent contains spaces as you might have noticed, which is fine as the
string is quoted (and <em>nginx</em> does some escaping on the contained string).
Now what'll happen if I put an IP address in the User Agent?
Right, due to greedy matching the rightmost <code>&lt;HOST&gt;</code> will match.
This will of course result in some serious problems.</p>
<p>As a malicious hacker I could:</p>
<ul>
<li>Circumvent <em>fail2ban</em> altogether by putting <code>127.0.0.1</code> into my User Agent.
That will effectively turn off <em>fail2ban</em> for my requests as long as
<code>127.0.0.1</code> is whitelisted. If that IP is not whitelisted, you've got
problems a lot worse (assuming <em>fail2ban</em> uses <em>iptables</em>, this will break at
least half of your server's software, think of accessing <em>MySQL</em> on
<em>localhost</em>).</li>
<li>Block arbitrary IPs from accessing your website in much the same way.</li>
</ul>
<p>So how are we going to construct a Regex that will match <strong>only</strong> what we're
looking for here?</p>
<p>Well, the IP is right at the start, so we'll take <code>m{^&lt;HOST&gt;.*$}</code> right?</p>
<p>Technically right, but I wouldn't write it that way.
That regex would again match everything after the IP, but <em>we really don't care
about that</em>.</p>
<p>What we should do is a simple <code>m{^&lt;HOST&gt;}</code>.
This works as intended and it does only look at the first few characters.
If you want to make sure that it's followed by a space, go ahead, please.</p>
<p>So we end up with a fool-proof regex: <code>m{^&lt;HOST&gt;\s}</code>.
This will for sure fulfill all our needs.</p>
<p>To be honest, this example is kind of easy as the IP is right at the start.
Let's assume some other format so we can work out a more general way for this
to work.</p>
<h3 id="copy-paste-replace"><a class="header" href="#copy-paste-replace">Copy, Paste, Replace</a></h3>
<p>We are going to perform CPR on a line of text.
As said above, this time we want to get something that is <em>not</em> right at the
start.
We'll look at the following line:</p>
<pre><code class="language-text">[16/Jul/2017:16:27:41 +0200] openbsd.cloud.bsocat.net - - 66.133.109.36 "GET /.well-known/acme-challenge/tTRnUGY9gZEVz2llGWqn1m3mHznMDOFH3zCXsgelh7w HTTP/1.1" 200 87
</code></pre>
<p>This is a slightly modified OpenBSD httpd log-format.
By <em>slightly</em> I mean:</p>
<ul>
<li>date and time moved to the front</li>
<li>host moved a bit backwards</li>
</ul>
<p>Now let's do this:</p>
<pre><code class="language-text"># copy the line, verbatim
[16/Jul/2017:16:27:41 +0200] openbsd.cloud.bsocat.net - - 66.133.109.36 "GET /.well-known/acme-challenge/tTRnUGY9gZEVz2llGWqn1m3mHznMDOFH3zCXsgelh7w HTTP/1.1" 200 87

# remove everything after the needle (except for the delimiter), we don't need it
[16/Jul/2017:16:27:41 +0200] openbsd.cloud.bsocat.net - - 66.133.109.36\s

# add needed meta-characters (start of line)
^[16/Jul/2017:16:27:41 +0200] openbsd.cloud.bsocat.net - - 66.133.109.36\s

# escape all the characters that need escaping
^\[16/Jul/2017:16:27:41 \+0200\] openbsd\.cloud\.bsocat\.net - - 66\.133\.109\.36\s

# replace the host
^\[16/Jul/2017:16:27:41 \+0200\] openbsd\.cloud\.bsocat\.net - - &lt;HOST&gt;\s

# replace everything that is not static by their possible values
# this requires a lot of in depth knowledge about the log format
# let's do this the easy way and just replace using dots for the date
^\[../.../....:..:..:.. .....\] openbsd\.cloud\.bsocat\.net - - &lt;HOST&gt;\s

# for the other fields we just specify them to "not contain spaces" as these
# are used for delimiting, so they will not occur in the fields
^\[../.../....:..:..:.. .....\] [^\s]+ [^\s]+ [^\s]+ &lt;HOST&gt;\s

# fail2ban needs spaces escaped I think
^\[../.../....:..:..:..\s.....\]\s[^\s]+\s[^\s]+\s[^\s]+\s&lt;HOST&gt;\s
</code></pre>
<h3 id="how-do-we-check"><a class="header" href="#how-do-we-check">How do we check?</a></h3>
<p>If it's <em>fail2ban</em>, just run that.
For everything else:</p>
<pre><code class="language-bash">perl -ne 'm{^\[../.../....:..:..:..\s.....\]\s[^\s]+\s[^\s]+\s[^\s]+\s([^\s]+)\s} &amp;&amp; print "$1\n"'
</code></pre>
<p>This should output only the IP we were looking for.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="assignments"><a class="header" href="#assignments">Assignments</a></h1>
<p>So, every once in a while a friend of mine gets into computer science (or something else entirely).
I get curious.
Like really curious.
I know they're a beginner when coding and I'm throwing way too many fancy concepts at them, but I wanna do things properly so friggin' badly.</p>
<p>Sometimes I do some assignments.
Not for them.
Not for me.
Just for the sake of it.</p>
<p>This is a collection.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="finbean-linked-list"><a class="header" href="#finbean-linked-list">Finbean Linked List</a></h1>
<h2 id="finbean"><a class="header" href="#finbean">Finbean</a></h2>
<p>If you don't know <a href="https://twitch.tv/psycho_manatee">Finbean</a> then this meta-paragraph probably doesn't concern you.
Basically Finbean studies computer science and writes code.
Rookie code I'd probably say, but we've all been rookies at some point, and there's only so far you can make someone go on their assignments, so sometimes you code along.</p>
<h2 id="the-assignment"><a class="header" href="#the-assignment">The Assignment</a></h2>
<p>I don't know exactly what the assignment was, it was something about storing cuisines in a list, and you had to craft the list yourself I assume (otherwise, what the heck Finbean, that assignment would've taken like two minutes).
Anyway, language is C++ and the "IDE" was vim, which <em>is</em> powerful enough as it is.
Since I use vim daily <a href="https://github.com/benaryorg/dotfiles">my configuration</a> is elaborate, and my toolchain consists of a long list of compiler flags and some additional tools (like <em>valgrind</em> or <em>gdb</em>).
For this assignment however I used <a href="https://www.onlinegdb.com/9C4vV0Rv30">onlinegdb.com</a> as it was easiest, despite running Gentoo and therefore having C++ compilers at hand on every single machine I have.</p>
<h2 id="code"><a class="header" href="#code">Code</a></h2>
<p>Back on track, this is the code (ISC licensed):</p>
<pre><code class="language-cpp">/*
 * Copyright (c) 2022 benaryorg &lt;binary@benary.org&gt;
 *
 * Permission to use, copy, modify, and distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

// compile using:
//  g++ \
//    -pedantic -Wall -Wextra -Wcast-align -Wcast-qual -Wctor-dtor-privacy -Wdisabled-optimization
//    -Wformat=2 -Winit-self -Wlogical-op -Wmissing-declarations -Wmissing-include-dirs -Wnoexcept
//    -Wold-style-cast -Woverloaded-virtual -Wredundant-decls -Wsign-conversion -Wsign-promo
//    -Wstrict-null-sentinel -Wstrict-overflow=5 -Wswitch-default -Wundef -Wno-unused -Werror

#include &lt;iostream&gt;
#include &lt;memory&gt;

using namespace std;

typedef void (*iter_func)(const string *data);

void print_node(const string *);

class MyNode
{
	string data;
	unique_ptr&lt;MyNode&gt; next { nullptr };

public:
	MyNode(string data)
	{
		this-&gt;data = data;
	}

	bool eq(string data)
	{
		return this-&gt;data == data;
	}

	void iterate(iter_func func)
	{
		func(&amp;this-&gt;data);
		if(this-&gt;next)
		{
			this-&gt;next-&gt;iterate(func);
		}
	}

	void insert(string data)
	{
		if(data &lt; this-&gt;data)
		{
			unique_ptr&lt;MyNode&gt; old = move(this-&gt;next);
			this-&gt;next = unique_ptr&lt;MyNode&gt;(new MyNode(this-&gt;data));
			this-&gt;data = data;
			this-&gt;next-&gt;next = move(old);
		}
		else
		{
			if(this-&gt;next)
			{
				this-&gt;next-&gt;insert(data);
			}
			else
			{
				this-&gt;next = unique_ptr&lt;MyNode&gt;(new MyNode(data));
			}
		}
	}

	bool remove(string data)
	{
		if(!this-&gt;next)
		{
			return false;
		}
		if(this-&gt;next-&gt;eq(data))
		{
			this-&gt;next = move(this-&gt;next-&gt;next);
			return true;
		}
		return this-&gt;next-&gt;remove(data);
	}

	unique_ptr&lt;MyNode&gt; split_after()
	{
		return move(this-&gt;next);
	}
};

class MyList
{
	unique_ptr&lt;MyNode&gt; head { nullptr };

public:
	MyList()
	{
	}

	void iterate(iter_func func)
	{
		if(this-&gt;head)
		{
			this-&gt;head-&gt;iterate(func);
		}
	}

	void insert(string data)
	{
		if(this-&gt;head)
		{
			this-&gt;head-&gt;insert(data);
		}
		else
		{
			this-&gt;head = unique_ptr&lt;MyNode&gt;(new MyNode(data));
		}
	}

	bool remove(string data)
	{
		if(!this-&gt;head)
		{
			return false;
		}
		return false;
		if(this-&gt;head-&gt;eq(data))
		{
			this-&gt;head = this-&gt;head-&gt;split_after();
			return true;
		}
		return this-&gt;head-&gt;remove(data);
	}
};

void print_node(const string *data)
{
	cout &lt;&lt; "data: " &lt;&lt; *data &lt;&lt; endl;
}

int main()
{
	unique_ptr&lt;MyList&gt; list(new MyList());

	cout &lt;&lt; "first run (empty):" &lt;&lt; endl;
	list-&gt;iterate(print_node);

	list-&gt;insert("tomato salad");
	cout &lt;&lt; "second run (1):" &lt;&lt; endl;
	list-&gt;iterate(print_node);

	list-&gt;insert("french fries");
	cout &lt;&lt; "third run (2):" &lt;&lt; endl;
	list-&gt;iterate(print_node);

	list-&gt;insert("potato salad");
	cout &lt;&lt; "fourth run (3):" &lt;&lt; endl;
	list-&gt;iterate(print_node);

	list-&gt;insert("marinated manatee");
	cout &lt;&lt; "fifth run (4):" &lt;&lt; endl;
	list-&gt;iterate(print_node);

	list-&gt;remove("marinated manatee");
	cout &lt;&lt; "sixth run (3):" &lt;&lt; endl;
	list-&gt;iterate(print_node);

	return 0;
}
</code></pre>
<h2 id="questionare"><a class="header" href="#questionare">Questionare</a></h2>
<p>Besides writing this and answering questions if people had some (also teaching some peers how to use the basics of <em>gdb</em>, though that's not quite related to this) there was also this questionaire that came up in the end.
This was also relayed by Finbean, and of course it may very well be subject to intellectual property, so I reproduce these questions here hoping that neither me nor Finbean will be reprimanded for it.
If you want it taken down hit me up via the media of your choice, <a href="https://benary.org">my website</a><sup class="footnote-reference"><a href="#ipv6_only">1</a></sup> should list <em>something</em> you can use.</p>
<div class="footnote-definition" id="ipv6_only"><sup class="footnote-definition-label">1</sup>
<p>Note the website is IPv6-only, file a complaint with your ISP if you can't access it, though I can't help but think that my infrastructure may be at fault.</p>
</div>
<h3 id="used-structure"><a class="header" href="#used-structure">Used Structure</a></h3>
<blockquote>
<p>a. How well did the data structure selected perform for the assigned application?</p>
</blockquote>
<p>I chose a list with most methods implemented via tail recursive calls on the nodes.
This performed reasonably well since the ergonomics are at focus for this assignment.
Had performance in terms of memory, cpu, or scalability constraints been an issue the lack of short-circuiting in the iterative approach of traversing the list would have been a limiting factor.</p>
<h3 id="alternative-structures"><a class="header" href="#alternative-structures">Alternative Structures</a></h3>
<blockquote>
<p>b. Would a different data structure work better? If so, which one and why...</p>
</blockquote>
<p>My list was singly linked, therefore implementation complexity was low which was the important thing here.
It also was more of a set-like approach (a PriorityQueue in Java or BinaryHeap in Rust), keeping the list sorted internally at all times, this would've allowed some performance improvements, though nothing big compared to the alternatives.
However for performance reasons a hashset or hashmap would have been more suitable.
The constant-time of hashing adds some overhead but allows O(log(n)) indexing which for large sets of data outperforms any iterative approach.</p>
<h3 id="efficiency-considerations-of-used-structure"><a class="header" href="#efficiency-considerations-of-used-structure">Efficiency Considerations of Used Structure</a></h3>
<blockquote>
<p>c. What was efficient about your design and use of the data structure?</p>
</blockquote>
<p>The tail recursion did make up for constant memory usage while keeping implementation complexity to a minimum.
The separation of list and node functions, the latter carrying the brunt of logic, did allow for a separation of internals and interface while still keeping internals structured.
Keeping the list sorted internally was also a benefit when it comes to search, but that was barely necessary.
If insertion speed was key, then this would indeed be a serious flaw.</p>
<h3 id="ineffeciencies-of-used-structure"><a class="header" href="#ineffeciencies-of-used-structure">Ineffeciencies of Used Structure</a></h3>
<blockquote>
<p>d. What was not efficient?</p>
</blockquote>
<p>Insertion speed mostly, but as said, everything compared to a hash-approach.</p>
<h3 id="critical-approach"><a class="header" href="#critical-approach">Critical Approach</a></h3>
<blockquote>
<p>e. What would you do differently if you had more time to solve the problem?</p>
</blockquote>
<p>Throw math at the problem, in a nutshell.
Many existing algorithms are faster than mine mathematically. I'd leverage them where possible.</p>
<p>For <em>e</em> I'd like to add that if I had more time I'd like to have a talk with the product owners or stakeholders (or whatever internal position is responsible for clarifying requirements) as to what use-case should be optimised for.
Are we focusing write speed? Memory compactness? Search time?
The solution strongly depends on these, for example Perfect Hash Functions (PHFs) can be used to achieve constant time access in a map, which would be useful if the list was either constant/static or rarely ever changed.
Adding new elements would be terribly expensive then though.
Also, a database might be much better suited if filtering was important.</p>
<p>If complexity would rise above basic types of sets or lists then I'd very likely opt for using an in-memory sqlite database, which is both trivial in terms of license (public domain) as well as embeddable (it's in virtually every smartphone) and highly performant [citation needed] and scalable (unless you require parallel writable access).
It also serialises nicely, and can leverage edge cases such as expensive flash storage by using append-mechanisms and whatnot.
Basically for storing structured data, sqlite is the way to go if you need querying.</p>
<h2 id="words-to-the-professor"><a class="header" href="#words-to-the-professor">Words to the Professor</a></h2>
<p>I know I didn't fully finish the assignment, heck I didn't even have access to it to begin with, however I'd like your honest opinion on this if possible.
To add a few things about my code: yes, my class naming sounds more like a tutorial than anything.
Also, I would've gone the full route and either use templating or generics to get myself a generic list, or map even, that would allow me to re-use it for several parts of the assignment, again the full scope of which I didn't have access to, hence I only ever implemented the basic list type and the bare minimum of methods on it.
Also, I'm "new" to C++, usually sticking to Rust, C, and various scripting language since I'm a systems administrator by profession (though both developer and devops suite my skillset equally well), hence not making use of the very powerful features of templating that C++ offers, a double edged sword, but one that when wielded properly can be a game-changer.
In practice I'd stay away from templating though, since maintainability decreases drastically in such cases, and in my opinion maintainability is more important than performance often enough.
Also note that modern compilers optimize better than humans can do, so the best we can do is choose an approach and algorithm and hope for the best, implementation specifics rarely matter, and making the code concise on a high-level often increases speed due to abstractions applied by the optimisation layer, such as tail-call optimisation.</p>
<p>Feel free to send me an email if you can be bothered to go through this.</p>
<h3 id="further-info"><a class="header" href="#further-info">Further Info</a></h3>
<p>By the way, examples of such optimisations are the rigorous use of call-by-value even for large structs.
The compiler will figure out how to pass it indirectly or how to make use of the stack.
Generally I prefer using the stack wherever possible for that reason exactly.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
